"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5639],{3663:function(e,t,a){var s=a(7437),r=a(4662),n=a(9733),i=a(6648),o=a(7138);t.Z=e=>{let{isOpen:t,onOpenChange:a}=e;return(0,s.jsx)(r.Dialog,{open:t,onOpenChange:a,children:(0,s.jsx)(r.DialogContent,{className:"max-w-[350px]",children:(0,s.jsxs)(r.DialogHeader,{className:"flex flex-col justify-center",children:[(0,s.jsx)(i.default,{src:"/heart24.png",alt:"Heart",width:100,height:100,className:"mx-auto"}),(0,s.jsxs)(r.DialogTitle,{className:"text-center lg:text-xl lg:leading-7 font-bold",children:["Войдите в аккаунт, ",(0,s.jsx)("br",{})," чтобы ставить лайки и сохранять музыкальные предпочтения"]}),(0,s.jsxs)(r.DialogDescription,{className:"!mt-5",children:[(0,s.jsx)(n.z,{asChild:!0,className:"w-full font-bold mb-2",children:(0,s.jsx)(o.default,{href:"/login",children:"Войти"})}),(0,s.jsx)(n.z,{asChild:!0,variant:"secondary",className:"w-full",children:(0,s.jsx)(o.default,{href:"/signup",children:"Создать аккаунт"})})]})]})})})}},6177:function(e,t,a){a.d(t,{default:function(){return z}});var s=a(7437),r=a(2265);function n(e){let{reviewContent:t,reviewTitle:a,variant:r,role:n,isOpen:i,media_review:o,reviewDate:l}=e;t.split(/\r\n|\n/).filter(Boolean);let d=t.slice(0,130),c=String(t).replace(/(?:\r\n|\r|\n)/g,"<br>");return(0,s.jsxs)("div",{className:"".concat("compact"!==r||i?"max-h-min":"max-h-[120px]"," overflow-hidden relative transition-all duration-300 mb-4 px-1.5 ").concat(o&&"compact"===r?"hidden":""),children:[a&&!o&&(0,s.jsx)("div",{className:"text-base lg:text-lg mt-3 mb-2 font-semibold",children:a}),"compact"===r?(0,s.jsx)("div",{className:"mt-2 tracking-[-0.2px] font-light",children:o?null:i?(0,s.jsxs)("div",{className:"prose prose-invert prose-p:mt-1 text-white max-w-full text-[15px] lg:text-base lg:leading-[150%] pr-4 ",children:[(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:c}}),(0,s.jsx)("div",{className:"text-xs opacity-60 mt-1",children:l})]}):(0,s.jsxs)("div",{className:"prose prose-invert text-[15px] text-white lg:text-base lg:leading-[150%]",children:[d,"..."]})}):(0,s.jsxs)("div",{className:"prose prose-invert prose-p:mt-1 text-white max-w-full text-[15px] lg:text-lg lg:leading-[32px] font-light tracking-[-0.2px] pr-4",children:[(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:c}}),(0,s.jsx)("div",{className:"text-xs opacity-60 mt-1",children:l})]})]})}var i=a(6648),o=a(9733),l=a(8068),d=a(3663),c=a(7476);a(4590);var u=a(8064),f=(0,u.$)("600d6b2278dcde53df39b8902995812baab254ef"),x=(0,u.$)("1fd73e7481de72dfcd4804fc31b1214915719731"),m=a(2649),p=e=>{let{reviewId:t,initialLikesCount:a,userHasLiked:n}=e,{toast:u}=(0,l.pm)(),[p,g]=(0,r.useState)(!1),[h,v]=(0,r.useState)(a),[j,b]=(0,r.useState)(n),[w,N]=(0,r.useState)(!1),[y,T]=(0,r.useState)(null),[z,S]=(0,r.useState)(!1),[D,C]=(0,r.useState)(0),[_,k]=(0,r.useState)(!1);m.Z.get("is_authenticated"),(0,r.useEffect)(()=>{g("true"===m.Z.get("is_authenticated"))},[]),(0,r.useEffect)(()=>{n&&S(!1)},[n]),(0,r.useEffect)(()=>{if(y){let e=setInterval(()=>{Date.now()-y>=1e4&&(S(!1),clearInterval(e))},1e3);return()=>clearInterval(e)}},[y]);let O=async()=>{if(!w){if(!p){k(!0);return}if(j&&!z){u({description:"Лайк убрать уже нельзя",variant:"destructive"});return}N(!0);try{if(j&&z&&D<1){let e=await f(t);e.success?(v(e=>e-1),b(!1),C(e=>e+1),S(!1),u({description:"Вы убрали лайк"})):u({description:e.message||"Не удалось убрать лайк",variant:"destructive"})}else if(!j){let e=await x(t);e.success?(v(e=>e+1),b(!0),S(!0),T(Date.now()),u({description:"Лайк успешно поставлен"})):u({description:e.message||"Не удалось поставить лайк",variant:"destructive"})}}catch(e){console.error("Ошибка при добавлении лайка:",e),u({description:e instanceof Error?e.message:"Произошла ошибка",variant:"destructive"})}finally{N(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(o.z,{onClick:O,variant:"ghost",className:"\n          border group bg-white/5 max-lg:h-8 ".concat(j&&!z?"cursor-default hover:bg-white/20":"cursor-pointer"," flex items-center rounded-full gap-x-1 lg:gap-x-1.5 ").concat(j?"bg-white/20 border-white/40 border":"","\n        "),disabled:w,children:[(0,s.jsx)("div",{className:"w-5 lg:w-7",children:w?(0,s.jsx)(c.dAq,{className:"size-6 animate-spin"}):(0,s.jsx)(i.default,{src:"/hearts/heart24.png",alt:j?"Liked":"Unliked",width:30,height:25,className:" ".concat(j?"opacity-100":"opacity-50"," transition-all duration-300 group-hover:opacity-100")})}),h>0&&(0,s.jsx)("span",{className:"font-bold lg:text-lg",children:h})]}),(0,s.jsx)(d.Z,{isOpen:_,onOpenChange:k})]})},g=a(3872),h=a(9736);function v(e){let{isOpen:t,onToggle:a}=e;return(0,s.jsxs)(h.Tooltip,{children:[(0,s.jsx)(h.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(o.z,{onClick:a,size:"icon",variant:"ghost",className:"size-8 md:size-10",children:t?(0,s.jsx)(g.tjB,{className:"size-6 fill-zinc-400"}):(0,s.jsx)(g.z5B,{className:"size-5 md:size-6 fill-zinc-400"})})}),(0,s.jsx)(h.TooltipContent,{children:"Открыть рецензию полностью"})]})}var j=a(7138),b=a(9721);function w(e){let{reviewUrl:t,reviewImage:a,reviewTitle:r,variant:n}=e,l="compact"===n&&r&&r.length>35?r.slice(0,35)+"...":r;return(0,s.jsxs)(j.default,{href:t,target:"_blank",className:"flex text-sm items-stretch justify-stretch h-[120px] gap-3 w-full mt-2 mb-2 bg-white/5 border border-zinc-700 p-1 rounded-lg",children:[(0,s.jsx)("div",{className:"flex justify-center items-center aspect-video max-md:max-h-[70px] relative",children:(0,s.jsx)(i.default,{src:a||"/noimage-single.png",alt:r||"Media Review",fill:!0,className:"rounded-md object-cover object-center "})}),(0,s.jsxs)("div",{className:"flex h-full justify-between flex-col min-h-full flex-grow py-2",children:[l&&(0,s.jsx)("div",{className:"text-sm lg:text-base font-semibold",children:l}),t&&(0,s.jsxs)(o.z,{variant:"ghost",className:"flex items-center gap-2 border border-zinc-700 mt-auto max-md:text-xs w-[130px] md:w-[170px] h-8",children:[(0,s.jsx)("span",{children:"Рецензия медиа"}),(0,s.jsx)("span",{className:"text-white text-center",children:(0,s.jsx)(b.lzP,{})})]})]})]})}var N=a(9824);function y(e){let{reviewId:t}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(h.Tooltip,{children:[(0,s.jsx)(h.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(o.z,{asChild:!0,size:"icon",className:"size-8 md:size-10 bg-transparent hover:bg-white/10 ",children:(0,s.jsx)(j.default,{href:"/reviews/".concat(t),children:(0,s.jsx)(N.qSo,{className:"size-4 fill-zinc-400"})})})}),(0,s.jsx)(h.TooltipContent,{children:"Перейти к рецензии"})]})})}function T(e){let{author_likes:t}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-wrap -space-x-2 relative ml-3",children:[(0,s.jsx)(i.default,{src:"/hearts/rubin_heart.png",width:25,height:25,alt:"Авторский лайк РЗТ",className:"size-[25px] absolute -right-[13px] -bottom-[5px]"}),t.map(e=>(0,s.jsx)("div",{className:"flex items-center gap-x-2",children:(0,s.jsxs)(h.Tooltip,{children:[(0,s.jsx)(h.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(j.default,{href:"/user/".concat(e.id),children:(0,s.jsx)(i.default,{width:34,height:34,src:e.avatar||"/noimage-single.png",alt:e.avatar?"".concat(e.name,"' аватар"):"нет аватара",className:"size-[34px] rounded-full border-2 shrink-0"})})}),(0,s.jsx)(h.TooltipContent,{className:"border-2 border-white/20 py-0.5 px-2.5",children:e.name})]})},e.id))]})})}function z(e){let{review:t,variant:a,role:i}=e,{content:{rendered:o}={rendered:""},meta:{comment_title:l="",review_url:d="",review_image:c="",media_review:u=!1}={},likes_count:f,user_has_liked:x,author_likes:m}=t||{},[g,h]=(0,r.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[u&&(0,s.jsx)(w,{reviewUrl:d,reviewImage:c,reviewTitle:l,variant:a}),(0,s.jsx)(n,{reviewContent:o,reviewTitle:l,reviewDate:t.date,variant:a,role:i,media_review:u,isOpen:g}),(0,s.jsxs)("div",{className:"mt-auto flex justify-between items-center relative pr-1.5",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(p,{reviewId:t.id,initialLikesCount:f,userHasLiked:x}),m&&m.length>0&&(0,s.jsx)(T,{author_likes:m})]}),(0,s.jsxs)("div",{className:"relative flex items-center gap-x-0.5 ",children:["compact"===a&&(0,s.jsx)(y,{reviewId:t.id}),"compact"===a&&(0,s.jsx)(v,{isOpen:g,onToggle:()=>{h(e=>!e)}})]})]})]})}},9733:function(e,t,a){a.d(t,{d:function(){return l},z:function(){return d}});var s=a(7437),r=a(2265),n=a(1538),i=a(2218),o=a(9354);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-white/20 bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:r,size:i,className:a})),ref:t,...c})});d.displayName="Button"},4662:function(e,t,a){a.r(t),a.d(t,{Dialog:function(){return l},DialogClose:function(){return u},DialogContent:function(){return x},DialogDescription:function(){return h},DialogFooter:function(){return p},DialogHeader:function(){return m},DialogOverlay:function(){return f},DialogPortal:function(){return c},DialogTitle:function(){return g},DialogTrigger:function(){return d}});var s=a(7437),r=a(2265),n=a(3304),i=a(4697),o=a(9354);let l=n.fC,d=n.xz,c=n.h_,u=n.x8,f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.aV,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});f.displayName=n.aV.displayName;let x=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(f,{}),(0,s.jsxs)(n.VY,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] rounded-lg z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",a),...l,children:[r,(0,s.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=n.VY.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Dx,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});g.displayName=n.Dx.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.dk,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});h.displayName=n.dk.displayName},8006:function(e,t,a){a.r(t),a.d(t,{HybridTooltip:function(){return c},HybridTooltipContent:function(){return f},HybridTooltipTrigger:function(){return u},TouchProvider:function(){return d}});var s=a(7437),r=a(2265),n=a(9736),i=a(1413);let o=(0,r.createContext)(void 0),l=()=>(0,r.useContext)(o),d=e=>{let[t,a]=(0,r.useState)();return(0,r.useEffect)(()=>{a(window.matchMedia("(pointer: coarse)").matches)},[]),(0,s.jsx)(o.Provider,{value:t,...e})},c=e=>l()?(0,s.jsx)(i.Popover,{...e}):(0,s.jsx)(n.Tooltip,{delayDuration:0,...e}),u=e=>l()?(0,s.jsx)(i.PopoverTrigger,{...e}):(0,s.jsx)(n.TooltipTrigger,{...e}),f=e=>l()?(0,s.jsx)(i.PopoverContent,{...e}):(0,s.jsx)(n.TooltipContent,{...e})},1413:function(e,t,a){a.d(t,{Popover:function(){return o},PopoverContent:function(){return d},PopoverTrigger:function(){return l}});var s=a(7437),r=a(2265),n=a(1485),i=a(9354);let o=n.fC,l=n.xz,d=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:o=4,side:l="top",...d}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsx)(n.VY,{ref:t,align:r,sideOffset:o,side:l,className:(0,i.cn)("z-50 w-auto rounded-xl border-2 bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...d})})});d.displayName=n.VY.displayName},9736:function(e,t,a){a.r(t),a.d(t,{Tooltip:function(){return l},TooltipContent:function(){return c},TooltipProvider:function(){return o},TooltipTrigger:function(){return d}});var s=a(7437),r=a(2265),n=a(7071),i=a(9354);let o=n.zt,l=n.fC,d=n.xz,c=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...o}=e;return(0,s.jsx)(n.VY,{ref:t,sideOffset:r,className:(0,i.cn)("z-50 overflow-hidden rounded-xl border-2 bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})});c.displayName=n.VY.displayName},8068:function(e,t,a){a.d(t,{pm:function(){return f}});var s=a(2265);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function f(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9354:function(e,t,a){a.d(t,{cn:function(){return n}});var s=a(4839),r=a(6164);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}a(357)}}]);